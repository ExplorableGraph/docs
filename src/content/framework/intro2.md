---
title: Create virtual files with formulas
numberHeadings: true
intro = client/samples/frameworkIntro:
# Mocks for the code samples below
files:
  src: |
    "+.yaml": |
      # Origami formulas for the About Us web site.
      message: Hello, world!
virtual:
  src = graphVirtual(files/src):
---

Origami lets you create virtual folders and files using formulas.

## Define a virtual file in a YAML or JSON file

<span class="tutorialStep"></span> Inside the `src` folder, open the file called `+.yaml`. This file initially just contains a comment:

```{{'yaml'}}
{{ intro/siteInitial.yaml }}
```

The name of the `+.yaml` is a signal to the Origami framework that anything inside the file should be considered a virtual member of the containing folder. Any values you define inside that file will appear as if they exist in the containing `src` folder.

This file could also be a JSON file, but we'll use a YAML file for this tutorial because it'll be more concise. The file could be called anything that starts with a plus sign, like `+formulas.yaml`. The `+` suggests that the file's contents will be added to the container.

<span class="tutorialStep"></span> Add a line to the `+.yaml` file:

```{{'yaml'}}
{{ intro/siteMessage.yaml }}
```

(If you're using StackBlitz, it may display a message saying "Project forked" to indicate that you're now working in your own copy of the tutorial project.)

The line you've just added defines a key called `message` with a value of "Hello, world!" Because that key/value definition is sitting in a file called `+.yaml`, the Origami framework will create a virtual key — a virtual file — in the containing `src` folder when that folder is viewed in the browser (or, later, through the command line).

## View the virtual value

<span class="tutorialStep"></span> Without needing to do anything else, in the browser pane/window showing your served site, navigate to the `src` folder.

You will see a listing that includes an entry for `message`. Text next to it in gray indicates this is a virtual file generated by the above formula.

<span class="tutorialStep"></span> Click on the `message` link to navigate to a page that says "Hello, world!"

The ori web server is aware of Origami formulas. The server parses file names that contain formulas with an `=` sign and interprets them.

You don't have to use the Origami server: you can integrate the support for formulas into other servers (e.g., [Express](http://expressjs.com/)). Later in this tutorial you'll dispense with a live server altogether by building static files that you can host anywhere.

## Conceptualize real and virtual files as graphs

Origami includes a framework and a command line tool that use the same formula language. In addition to viewing the result of a formula in the served site as you did above, at any time you can also view the value of a formula in the command line with the command-line tool, ori.

<span class="tutorialStep"></span> In the terminal, press Ctrl+C to stop the running server, then:

```console assert: true, path: files
$ ls src
+.yaml
$ ori src
"+.yaml": |
  # Origami formulas for the About Us web site.
  message: Hello, world!
```

(Reminder: if running locally, you'll need to use `npx ori` whenever invoking the ori tool.)

If you ask ori to render the `src` folder, it returns a graph of the real files in the `src` folder. It displays this graph in YAML form. At the moment, there is just one file called `+.yaml` that defines a key called `message`.

You can also visualize this `src` folder graph:

<figure>
  {{ svg files/src }}
  <figcaption>The src folder graph has one real file</figcaption>
</figure>

If you ask ori to show the contents of a _virtual_ graph based on `src`, it interprets the formulas in file names. The resulting virtual graph includes _both_ the real files and any new virtual files implied by formulas.

<span class="tutorialStep"></span> View the virtual files:

```console assert: true, path: files
$ ori virtual/src
+.yaml: |
  # Origami formulas for the About Us web site.
  message: Hello, world!
message: Hello, world!
```

The `virtual` graph here includes a virtual `message` file that contains "Hello, world!". This `virtual` graph looks like:

<figure>
  {{ svg virtual/src }}
  <figcaption>Virtual graph includes the virtual message file</figcaption>
</figure>

The `src` files graph above is your starting point: the real files you create by transcribing the ideas and information in your head or collecting data from elsewhere. Through step-by-step transformations, you create a final `virtual` graph that represents the artifact you wish your audience to view or use.

_Transforming graphs is the fundamental operation of the Origami framework._

The ori command-line interface knows how to traverse graphs, including virtual graphs.

<span class="tutorialStep"></span> Ask ori to display a single virtual file on demand:

```console assert: true, path: files
$ ori virtual/src/message
Hello, world!
```

In the steps that follow, you will define Origami formulas to dynamically create data and HTML pages. At any point you can view those in the browser, or use ori to view those virtual files in the command line.

This is a trivial example of a formula; let's try something more interesting.

## Invoke a JavaScript function from a formula

If you don't consider yourself a JavaScript programmer, don't worry, JavaScript isn't necessary to build this particular site, or required to use Origami in general. We'll just use it here as just an example of how data might be transformed with regular JavaScript.

<span class="tutorialStep"></span> In the `src` folder, create a JavaScript file called `greet.js` and paste in the following:

```{{'js'}}
{{ intro/greet.js }}
```

You can use this `greet` formula in an Origami function to generate the contents of a virtual file.

<span class="tutorialStep"></span> Add the following line to the `+.yaml` file.

```yaml
hello.html = greet('world'):
```

Be sure to use single quotes, not double quotes. For cross-platform compatibility reasons, Origami doesn't recognize double quotes.

Also note the final `:` at the end of that line. You're defining a new _key_ in the YAML file that contains the whole formula. That key is everything before the colon. The value is whatever after the colon — in this case, no value is given, so the value is `null`. The virtual value we ultimately want is going to be defined by evaluating the formula.

This formula defines a virtual file called `hello.html`. The value or contents of that virtual file will be the result of invoking the function exported by the `greet.js` module. In Origami, this reference to `greet` will be interpreted as a reference to whatever is exported by `greet.js` — invoking the function you defined earlier.

<span class="tutorialStep"></span> View the contents of this virtual HTML page in the command line:

```console
$ ori virtual/src/hello.html
Hello, <em>world</em>!
```

<span class="tutorialStep"></span> Restart the server to view the virtual page in the served site:

```console
$ ori serve
```

<span class="tutorialStep"></span> Navigate to the `src` route, which will now show an entry for `hello.html`. Open that page to see "Hello, <em>world</em>!".

Each time you ask for `hello.html`, the web server evaluates the corresponding formula that invokes `greet`. Since the `greet` function is regular JavaScript, you can use that JavaScript to create HTML by any means you like. If the function is asynchronous, Origami will `await` the result before serving it to the browser. With that, you should be able to do essentially anything you want in the JavaScript function to create any HTML result.

A function like `greet` here transforms data from one form into another — in this case, it transforms a string name to an HTML greeting. The function and the file name formula that invokes it could just as easily transform other kinds of data; there's nothing special about text here.

&nbsp;

Next: [Thinking in graphs](intro3.html) »
